<article class="p-5 md:p-8 flex flex-col gap-2 md:gap-4" [attr.aria-busy]="!publication">
  <ng-container *ngIf="!!publication && publication.published; else skeleton">
    <ng-container *ngIf="publication.story as story">
      <header [lang]="story.language" class="card-header">
        <cuentoneta-story-edition-date-label [label]="editionLabel" />
      </header>
      <section [lang]="story.language">
        <h1 class="mb-1 text-ellipsis overflow-hidden whitespace-nowrap inter-body-xl-bold">{{ story.title }}</h1>
        <p class="hidden sm:source-serif-pro-body-base sm:text-ellipsis sm:relative sm:text-justify sm:min-h-18 sm:line-clamp-3" [innerHTML]="previewText"></p>
      </section>
      <time class="font-semibold text-gray-600 inter-body-xs-medium">
        {{ story.approximateReadingTime }} minutos de lectura
      </time>
      <hr />
      <footer class="flex flex-row justify-between items-center">
        <div class="flex flex-row items-center">
          <img
            class="rounded w-10 h-10 mr-3"
            width="40"
            height="40"
            [alt]="'Retrato de ' + story.author.name"
            [ngSrc]="story.author.imageUrl + '?h=40&w=40'"
          />
          <div>
            <label class="inter-body-base-semibold">{{ story.author.name }}</label>
            <ng-container *ngIf="story.author.nationality as nationality">
              <div class="flex items-center">
                <img
                  class="w-5 h-[15px] rounded"
                  width="20"
                  height="15"
                  [alt]="'Bandera de ' + nationality.country"
                  [ngSrc]="nationality.flag + '?w=20&h=15'"
                />
                <label class="text-gray-500 ml-2 inter-body-sm-semibold">{{ nationality.country }}</label>
              </div>
            </ng-container>
          </div>
        </div>
        <ng-container *ngIf="!!story.videoUrl"><div
            [title]="'Contiene material audiovisual'"
            class="w-6 h-6"
          >
            <img class="video" [alt]="'Contiene video'" src="assets/svg/video.svg" /></div>
        </ng-container>
      </footer>
    </ng-container>
  </ng-container>
</article>

<ng-template #skeleton>
  <ng-container *ngIf="!publication">
    <cuentoneta-story-card-skeleton [animation]="'progress'" />
  </ng-container>
  <ng-container *ngIf="!!publication && !publication.published">
    <cuentoneta-story-card-skeleton
      [animation]="false"
      [displayDate]="false"
      [editionLabel]="editionLabel"
      [comingNextLabel]="comingNextLabel"
    />
  </ng-container>
</ng-template>
